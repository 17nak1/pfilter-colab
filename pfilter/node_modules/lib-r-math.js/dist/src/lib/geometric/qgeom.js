"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var debug = require("debug");
var _general_1 = require("../common/_general");
var expm1_1 = require("../exp/expm1");
var ceil = Math.ceil, fmax2 = Math.max, log1p = Math.log1p;
var ML_POSINF = Number.POSITIVE_INFINITY, ISNAN = Number.isNaN;
var printer = debug('qgeom');
function qgeom(p, prob, lower_tail, log_p) {
    if (lower_tail === void 0) { lower_tail = true; }
    if (log_p === void 0) { log_p = false; }
    if (prob <= 0 || prob > 1) {
        return _general_1.ML_ERR_return_NAN(printer);
    }
    var rc = _general_1.R_Q_P01_boundaries(lower_tail, log_p, p, 0, ML_POSINF);
    if (rc !== undefined) {
        return rc;
    }
    if (ISNAN(p) || ISNAN(prob))
        return p + prob;
    if (prob === 1)
        return 0;
    return fmax2(0, ceil(expm1_1.R_DT_Clog(lower_tail, log_p, p) / log1p(-prob) - 1 - 1e-12));
}
exports.qgeom = qgeom;
//# sourceMappingURL=qgeom.js.map