"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var debug = require("debug");
var _general_1 = require("../common/_general");
var expm1_1 = require("../exp/expm1");
var expm1 = Math.expm1, log1p = Math.log1p, log = Math.log, exp = Math.exp, floor = Math.floor;
var ISNAN = Number.isNaN, R_FINITE = Number.isFinite;
var printer = debug('pgeom');
function pgeom(x, p, lowerTail, logP) {
    if (lowerTail === void 0) { lowerTail = true; }
    if (logP === void 0) { logP = false; }
    if (ISNAN(x) || ISNAN(p))
        return x + p;
    if (p <= 0 || p > 1) {
        return _general_1.ML_ERR_return_NAN(printer);
    }
    if (x < 0)
        return _general_1.R_DT_0(lowerTail, logP);
    if (!R_FINITE(x))
        return _general_1.R_DT_1(lowerTail, logP);
    x = floor(x + 1e-7);
    if (p === 1) {
        x = lowerTail ? 1 : 0;
        return logP ? log(x) : x;
    }
    x = log1p(-p) * (x + 1);
    if (logP)
        return expm1_1.R_DT_Clog(lowerTail, logP, x);
    else
        return lowerTail ? -expm1(x) : exp(x);
}
exports.pgeom = pgeom;
//# sourceMappingURL=pgeom.js.map