"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var debug = require("debug");
var _general_1 = require("../../common/_general");
var Kbessel_1 = require("./Kbessel");
var ISNAN = Number.isNaN;
var floor = Math.floor;
var printer = debug('bessel_k');
function bessel_k(x, alpha, expo) {
    if (expo === void 0) { expo = false; }
    var nb;
    var ize;
    if (ISNAN(x) || ISNAN(alpha))
        return x + alpha;
    if (x < 0) {
        _general_1.ML_ERROR(_general_1.ME.ME_RANGE, 'bessel_k', printer);
        return NaN;
    }
    ize = expo ? 2 : 1;
    if (alpha < 0)
        alpha = -alpha;
    nb = 1 + floor(alpha);
    alpha -= (nb - 1);
    var rc = Kbessel_1.K_bessel(x, alpha, nb, ize);
    if (rc.ncalc !== rc.nb) {
        if (rc.ncalc < 0)
            printer('bessel_k(%d): ncalc (=%d) != nb (=%d); alpha=%d. Arg. out of range?\n', rc.x, rc.ncalc, rc.nb, alpha);
        else
            printer('bessel_k(%d,nu=%d): precision lost in result\n', rc.x, alpha + rc.nb - 1);
    }
    x = rc.x;
    return x;
}
exports.bessel_k = bessel_k;
//# sourceMappingURL=index.js.map