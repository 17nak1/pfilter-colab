'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
var debug = require("debug");
var _general_1 = require("../common/_general");
var csignrank_1 = require("./csignrank");
var round = Math.round, trunc = Math.trunc, fabs = Math.abs, log = Math.log, M_LN2 = Math.LN2;
var ISNAN = Number.isNaN;
var printer_dsignrank = debug('dsignrank');
function dsignrank(x, n, logX) {
    if (logX === void 0) { logX = false; }
    var rn = round(n);
    var u = rn * (rn + 1) / 2;
    var c = trunc(u / 2);
    var w = Array.from({ length: c + 1 }).fill(0);
    if (ISNAN(x) || ISNAN(n))
        return x + n;
    if (n <= 0) {
        return _general_1.ML_ERR_return_NAN(printer_dsignrank);
    }
    if (fabs(x - round(x)) > 1e-7) {
        return _general_1.R_D__0(logX);
    }
    x = round(x);
    if (x < 0 || x > n * (n + 1) / 2) {
        return _general_1.R_D__0(logX);
    }
    var d = _general_1.R_D_exp(logX, log(csignrank_1.csignrank(trunc(x), n, u, c, w)) - n * M_LN2);
    return d;
}
exports.dsignrank = dsignrank;
//# sourceMappingURL=dsign.js.map