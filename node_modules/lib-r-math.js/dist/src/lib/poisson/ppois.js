'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
var _general_1 = require("../common/_general");
var ISNAN = Number.isNaN, R_FINITE = Number.isFinite;
var floor = Math.floor, fmax2 = Math.max;
var debug = require("debug");
var pgamma_1 = require("../gamma/pgamma");
var printer = debug('ppois');
function ppois(x, lambda, lowerTail, logP) {
    if (lowerTail === void 0) { lowerTail = true; }
    if (logP === void 0) { logP = false; }
    if (ISNAN(x) || ISNAN(lambda))
        return x + lambda;
    if (lambda < 0) {
        return _general_1.ML_ERR_return_NAN(printer);
    }
    if (x < 0)
        return _general_1.R_DT_0(lowerTail, logP);
    if (lambda === 0)
        return _general_1.R_DT_1(lowerTail, logP);
    if (!R_FINITE(x))
        return _general_1.R_DT_1(lowerTail, logP);
    x = floor(x + 1e-7);
    return pgamma_1.pgamma(lambda, x + 1, 1, !lowerTail, logP);
}
exports.ppois = ppois;
function do_search(y, z, p, lambda, incr) {
    if (z.val >= p) {
        while (true) {
            if (y === 0 ||
                (z.val = ppois(y - incr, lambda, true, false)) < p)
                return y;
            y = fmax2(0, y - incr);
        }
    }
    else {
        while (true) {
            y = y + incr;
            if ((z.val = ppois(y, lambda, true, false)) >= p)
                return y;
        }
    }
}
exports.do_search = do_search;
//# sourceMappingURL=ppois.js.map